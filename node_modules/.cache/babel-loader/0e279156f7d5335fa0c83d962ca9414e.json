{"ast":null,"code":"/*\n\tHebcal - A Jewish Calendar Generator\n\tCopyright (C) 1994-2004  Danny Sadinoff\n\tPortions Copyright (c) 2002 Michael J. Radwin. All Rights Reserved.\n\n\thttps://github.com/hebcal/hebcal-js\n\n\tThis program is free software: you can redistribute it and/or modify\n\tit under the terms of the GNU General Public License as published by\n\tthe Free Software Foundation, either version 3 of the License, or\n\t(at your option) any later version.\n\n\tThis program is distributed in the hope that it will be useful,\n\tbut WITHOUT ANY WARRANTY; without even the implied warranty of\n\tMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n\tGNU General Public License for more details.\n\n\tYou should have received a copy of the GNU General Public License\n\talong with this program. If not, see <http://www.gnu.org/licenses/>.\n\n\tDanny Sadinoff can be reached at danny@sadinoff.com\n\n\tMichael Radwin has made significant contributions as a result of\n\tmaintaining hebcal.com.\n\n\tThe JavaScript code was completely rewritten in 2014 by Eyal Schachter.\n */\n\n/*\n * Many of the following algorithms were taken from hebrew calendar\n * routines by Maimonedes, from his Mishneh Torah, and implemented by\n *  Nachum Dershowitz                Department of Computer Science\n *  (217) 333-4219                   University of Illinois at Urbana-Champaign\n *  nachum@cs.uiuc.edu               1304 West Springfield Avenue\n *                                   Urbana, Illinois 61801\n *\n * The routines were included in the emacs 19 distribution.\n *\n */\nvar c = require('./common'),\n    HDate = require('./hdate');\n\nvar concat = 'concat',\n    range = c.range; // for client optimization\n\nvar INCOMPLETE = 0,\n    REGULAR = 1,\n    COMPLETE = 2;\n\nfunction Sedra(hebYr, il) {\n  // the Hebrew year\n  il = !!il;\n  var long_c = c.lngChesh(hebYr);\n  var short_k = c.shrtKis(hebYr);\n  var type;\n  this.year = hebYr;\n\n  if (long_c && !short_k) {\n    type = COMPLETE;\n  } else if (!long_c && short_k) {\n    type = INCOMPLETE;\n  } else {\n    type = REGULAR;\n  }\n\n  var rosh_hashana = new HDate(1, c.months.TISHREI, hebYr).abs();\n  var rosh_hashana_day = rosh_hashana % 7 + 1; // find the first Saturday on or after Rosh Hashana\n\n  this.first_saturday = c.dayOnOrBefore(6, rosh_hashana + 6);\n  var leap = +c.LEAP(hebYr);\n  this.type = type;\n  this.rosh_hashana_day = rosh_hashana_day;\n  this.leap = leap;\n  this.il = il;\n  var core = \"\" + leap + rosh_hashana_day + type;\n\n  if (types[core]) {\n    this.theSedraArray = types[core];\n  } else {\n    this.theSedraArray = types[core + +il]; // cast to num, then concat\n  }\n\n  if (!this.theSedraArray) {\n    console.log(this);\n    throw new TypeError(\"improper sedra year type calculated.\");\n  }\n}\n\nvar parshiot = Sedra.parshiot = [['Bereshit', 'Bereshis', 'בראשית'], // 0\n['Noach', 0, 'נח'], ['Lech-Lecha', 0, 'לך-לך'], ['Vayera', 0, 'וירא'], ['Chayei Sara', 0, 'חיי שרה'], ['Toldot', 'Toldos', 'תולדות'], ['Vayetzei', 0, 'ויצא'], ['Vayishlach', 0, 'וישלח'], ['Vayeshev', 0, 'וישב'], ['Miketz', 0, 'מקץ'], ['Vayigash', 0, 'ויגש'], // 10\n['Vayechi', 0, 'ויחי'], ['Shemot', 'Shemos', 'שמות'], ['Vaera', 0, 'וארא'], ['Bo', 0, 'בא'], ['Beshalach', 0, 'בשלח'], ['Yitro', 'Yisro', 'יתרו'], ['Mishpatim', 0, 'משפטים'], ['Terumah', 0, 'תרומה'], ['Tetzaveh', 0, 'תצוה'], ['Ki Tisa', 'Ki Sisa', 'כי תשא'], // 20\n['Vayakhel', 0, 'ויקהל'], ['Pekudei', 0, 'פקודי'], ['Vayikra', 0, 'ויקרא'], ['Tzav', 0, 'צו'], ['Shmini', 0, 'שמיני'], ['Tazria', 0, 'תזריע'], ['Metzora', 0, 'מצרע'], ['Achrei Mot', 'Achrei Mos', 'אחרי מות'], ['Kedoshim', 0, 'קדשים'], ['Emor', 0, 'אמור'], // 30\n['Behar', 0, 'בהר'], ['Bechukotai', 'Bechukosai', 'בחקתי'], ['Bamidbar', 0, 'במדבר'], ['Nasso', 0, 'נשא'], ['Beha\\'alotcha', 'Beha\\'aloscha', 'בהעלתך'], ['Sh\\'lach', 0, 'שלח לך'], ['Korach', 0, 'קורח'], ['Chukat', 'Chukas', 'חקת'], ['Balak', 0, 'בלק'], ['Pinchas', 0, 'פינחס'], // 40\n['Matot', 'Matos', 'מטות'], ['Masei', 0, 'מסעי'], ['Devarim', 0, 'דברים'], ['Vaetchanan', 'V\\'eschanan', 'ואתחנן'], ['Eikev', 0, 'עקב'], ['Re\\'eh', 0, 'ראה'], ['Shoftim', 0, 'שופטים'], ['Ki Teitzei', 'Ki Seitzei', 'כי תצא'], ['Ki Tavo', 'Ki Savo', 'כי תבוא'], ['Nitzavim', 0, 'נצבים'], // 50\n['Vayeilech', 0, 'וילך'], ['Ha\\'Azinu', 0, 'האזינו']]; // parsha doubler/undoubler\n\nfunction D(p) {\n  return -p;\n} // these are wrapped to protect them from [].concat()\n\n\nvar RH = [['Rosh Hashana', 0, 'ראש השנה']]; //0\n\nvar YK = [['Yom Kippur', 0, 'יום כיפור']]; //1\n\nvar SUKKOT = [['Sukkot', 'Succos', 'סוכות']]; //0\n\nvar CHMSUKOT = [['Chol hamoed Sukkot', 'Chol hamoed Succos', 'חול המועד סוכות']]; //0\n\nvar SHMINI = [['Shmini Atzeret', 'Shmini Atzeres', 'שמיני עצרת']]; //0\n\nvar EOY = [['End-of-Year: Simchat-Torah, Sukkot', 'End-of-Year: Simchas-Torah, Succos', 'סופשנה: סוכות וסמחת תורה']]; //0\n\nvar PESACH = [['Pesach', 0, 'פסח']]; //25\n\nvar CHMPESACH = [['Chol hamoed Pesach', 0, 'חול המועד פסח']]; //25\n\nvar PESACH7 = [['Second days of Pesach', 0, 'שביעי של פסח']]; //25\n\nvar SHAVUOT = [['Shavuot', 'Shavuos', 'שבועות']]; //33\n// The ordinary year types (keviot)\n// names are leap/nonleap - day - incomplete/regular/complete - diaspora/Israel\n\nvar types = {\n  /* Hebrew year that starts on Monday, is `incomplete' (Heshvan and\n   * Kislev each have 29 days), and has Passover start on Tuesday. */\n  //e.g. 5753\n  '020': [51, 52][concat](EOY, range(0, 20), D(21), 23, 24, PESACH, 25, D(26), D(28), 30, D(31), range(33, 40), D(41), range(43, 49), D(50)),\n\n  /* Hebrew year that starts on Monday, is `complete' (Heshvan and\n   * Kislev each have 30 days), and has Passover start on Thursday. */\n  //e.g. 5756\n  '0220': [51, 52][concat](EOY, range(0, 20), D(21), 23, 24, PESACH, 25, D(26), D(28), 30, D(31), 33, SHAVUOT, range(34, 37), D(38), 40, D(41), range(43, 49), D(50)),\n\n  /* Hebrew year that starts on Thursday, is `regular' (Heshvan has 29\n   * days and Kislev has 30 days), and has Passover start on Saturday. */\n  //e.g. 5701\n  '0510': [52][concat](YK, EOY, range(0, 20), D(21), 23, 24, PESACH, PESACH, 25, D(26), D(28), 30, D(31), range(33, 40), D(41), range(43, 50)),\n\n  /* Hebrew year that starts on Thursday, is `regular' (Heshvan has 29\n   * days and Kislev has 30 days), and has Passover start on Saturday. */\n  // e.g. 5745\n  '0511': [52][concat](YK, EOY, range(0, 20), D(21), 23, 24, PESACH, 25, D(26), D(28), range(30, 40), D(41), range(43, 50)),\n\n  /* Hebrew year that starts on Thursday, is `complete' (Heshvan and\n   * Kislev each have 30 days), and has Passover start on Sunday. */\n  //e.g. 5754\n  '052': [52][concat](YK, CHMSUKOT, range(0, 24), PESACH7, 25, D(26), D(28), 30, D(31), range(33, 40), D(41), range(43, 50)),\n\n  /* Hebrew year that starts on Saturday, is `incomplete' (Heshvan and Kislev\n   * each have 29 days), and has Passover start on Sunday. */\n  //e.g. 5761\n  '070': [][concat](RH, 52, SUKKOT, SHMINI, range(0, 20), D(21), 23, 24, PESACH7, 25, D(26), D(28), 30, D(31), range(33, 40), D(41), range(43, 50)),\n\n  /* Hebrew year that starts on Saturday, is `complete' (Heshvan and\n   * Kislev each have 30 days), and has Passover start on Tuesday. */\n  //e.g. 5716\n  '072': [][concat](RH, 52, SUKKOT, SHMINI, range(0, 20), D(21), 23, 24, CHMPESACH, 25, D(26), D(28), 30, D(31), range(33, 40), D(41), range(43, 49), D(50)),\n\n  /* --  The leap year types (keviot) -- */\n\n  /* Hebrew year that starts on Monday, is `incomplete' (Heshvan and\n   * Kislev each have 29 days), and has Passover start on Thursday. */\n  //e.g. 5746\n  '1200': [51, 52][concat](CHMSUKOT, range(0, 27), CHMPESACH, range(28, 33), SHAVUOT, range(34, 37), D(38), 40, D(41), range(43, 49), D(50)),\n\n  /* Hebrew year that starts on Monday, is `incomplete' (Heshvan and\n   * Kislev each have 29 days), and has Passover start on Thursday. */\n  //e.g. 5746\n  '1201': [51, 52][concat](CHMSUKOT, range(0, 27), CHMPESACH, range(28, 40), D(41), range(43, 49), D(50)),\n\n  /* Hebrew year that starts on Monday, is `complete' (Heshvan and\n   * Kislev each have 30 days), and has Passover start on Saturday. */\n  //e.g.5752\n  '1220': [51, 52][concat](CHMSUKOT, range(0, 27), PESACH, PESACH, range(28, 40), D(41), range(43, 50)),\n\n  /* Hebrew year that starts on Monday, is `complete' (Heshvan and\n   * Kislev each have 30 days), and has Passover start on Saturday. */\n  //e.g.5752\n  '1221': [51, 52][concat](CHMSUKOT, range(0, 27), PESACH, range(28, 50)),\n\n  /* Hebrew year that starts on Thursday, is `incomplete' (Heshvan and\n   * Kislev both have 29 days), and has Passover start on Sunday. */\n  //e.g. 5768\n  '150': [52][concat](YK, CHMSUKOT, range(0, 28), PESACH7, range(29, 50)),\n\n  /* Hebrew year that starts on Thursday, is `complete' (Heshvan and\n   * Kislev both have 30 days), and has Passover start on Tuesday. */\n  //eg. 5771\n  '152': [52][concat](YK, CHMSUKOT, range(0, 28), CHMPESACH, range(29, 49), D(50)),\n\n  /* Hebrew year that starts on Saturday, is `incomplete' (Heshvan and\n   * Kislev each have 29 days), and has Passover start on Tuesday. */\n  //e.g.5757\n  '170': [][concat](RH, 52, SUKKOT, SHMINI, range(0, 27), CHMPESACH, range(28, 40), D(41), range(43, 49), D(50)),\n\n  /* Hebrew year that starts on Saturday, is `complete' (Heshvan and\n   * Kislev each have 30 days), and has Passover start on Thursday. */\n  '1720': [][concat](RH, 52, SUKKOT, SHMINI, range(0, 27), CHMPESACH, range(28, 33), SHAVUOT, range(34, 37), D(38), 40, D(41), range(43, 49), D(50))\n};\n/* Hebrew year that starts on Monday, is `complete' (Heshvan and\n * Kislev each have 30 days), and has Passover start on Thursday. */\n\ntypes['0221'] = types['020'];\n/* Hebrew year that starts on Tuesday, is `regular' (Heshvan has 29\n * days and Kislev has 30 days), and has Passover start on Thursday. */\n//e.g. 5715\n\ntypes['0310'] = types['0220'];\n/* Hebrew year that starts on Tuesday, is `regular' (Heshvan has 29\n * days and Kislev has 30 days), and has Passover start on Thursday. */\n\ntypes['0311'] = types['020'];\n/* Hebrew year that starts on Tuesday, is `regular' (Heshvan has 29\n * days and Kislev has 30 days), and has Passover start on Saturday. */\n// e.g. 5715\n\ntypes['1310'] = types['1220'];\n/* Hebrew year that starts on Tuesday, is `regular' (Heshvan has 29\n * days and Kislev has 30 days), and has Passover start on Saturday. */\n\ntypes['1311'] = types['1221'];\n/* Hebrew year that starts on Saturday, is `complete' (Heshvan and\n * Kislev each have 30 days), and has Passover start on Thursday. */\n\ntypes['1721'] = types['170'];\n\nSedra.prototype.get = function (hDate) {\n  return abs(this, hDate.abs()).parsha;\n};\n\nSedra.prototype.isParsha = function (hDate) {\n  return !abs(this, hDate.abs()).chag;\n}; // returns an array describing the parsha on the first Saturday on or after absdate\n\n\nfunction abs(year, absDate) {\n  // find the first saturday on or after today's date\n  absDate = c.dayOnOrBefore(6, absDate + 6);\n  var weekNum = (absDate - year.first_saturday) / 7;\n  var index = year.theSedraArray[weekNum];\n\n  if (undefined === index) {\n    return abs(new Sedra(year.year + 1, year.il), absDate); // must be next year\n  }\n\n  if (typeof index == 'object') {\n    // Shabbat has a chag. Return a description\n    return {\n      parsha: [index],\n      chag: true\n    };\n  }\n\n  if (index >= 0) {\n    return {\n      parsha: [parshiot[index]],\n      chag: false\n    };\n  }\n\n  index = D(index); // undouble the parsha\n\n  return {\n    parsha: [parshiot[index], parshiot[index + 1]],\n    chag: false\n  };\n}\n\nmodule.exports = Sedra;","map":null,"metadata":{},"sourceType":"script"}