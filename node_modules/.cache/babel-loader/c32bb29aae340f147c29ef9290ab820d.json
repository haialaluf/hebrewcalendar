{"ast":null,"code":"/*\n\tHebcal - A Jewish Calendar Generator\n\tCopyright (C) 1994-2004  Danny Sadinoff\n\tPortions Copyright (c) 2002 Michael J. Radwin. All Rights Reserved.\n\n\thttps://github.com/hebcal/hebcal-js\n\n\tThis program is free software: you can redistribute it and/or modify\n\tit under the terms of the GNU General Public License as published by\n\tthe Free Software Foundation, either version 3 of the License, or\n\t(at your option) any later version.\n\n\tThis program is distributed in the hope that it will be useful,\n\tbut WITHOUT ANY WARRANTY; without even the implied warranty of\n\tMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n\tGNU General Public License for more details.\n\n\tYou should have received a copy of the GNU General Public License\n\talong with this program. If not, see <http://www.gnu.org/licenses/>.\n\n\tDanny Sadinoff can be reached at danny@sadinoff.com\n\n\tMichael Radwin has made significant contributions as a result of\n\tmaintaining hebcal.com.\n\n\tThe JavaScript code was completely rewritten in 2014 by Eyal Schachter.\n */\nvar c = require('./common'),\n    HDate = require('./hdate'),\n    gematriya = require('gematriya');\n\nvar __cache = {}; // for byte optimizations\n\nvar dayOnOrBefore = c.dayOnOrBefore,\n    months = c.months,\n    days = c.days,\n    TISHREI = months.TISHREI,\n    KISLEV = months.KISLEV,\n    NISAN = months.NISAN,\n    SAT = days.SAT,\n    getDay = 'getDay',\n    abs = 'abs',\n    Shabbat = 'Shabbat',\n    Shabbos = 'Shabbos';\n\nfunction Chanukah(day) {\n  return ['Chanukah: Candle ' + day, 0, 'חנוכה: נר ' + gematriya(day)];\n}\n\nfunction CHM(desc) {\n  return [desc[0] + ' (CH\"M)', desc[1] ? desc[1] + ' (CH\"M)' : desc[1], desc[2] ? desc[2] + ' )חה\"ם(' : desc[2]];\n}\n\nfunction Sukkot(day) {\n  return ['Sukkot: ' + day, 'Succos: ' + day, 'סוכות יום ' + gematriya(day)];\n}\n\nfunction Pesach(day) {\n  return ['Pesach: ' + day, 0, 'פסח יום ' + gematriya(day)];\n}\n\nvar USER_EVENT = 1,\n    LIGHT_CANDLES = 2,\n    YOM_TOV_ENDS = 4,\n    CHUL_ONLY = 8,\n    // chutz l'aretz (Diaspora)\nIL_ONLY = 16,\n    // b'aretz (Israel)\nLIGHT_CANDLES_TZEIS = 32;\nexports.masks = {\n  USER_EVENT: USER_EVENT,\n  LIGHT_CANDLES: LIGHT_CANDLES,\n  YOM_TOV_ENDS: YOM_TOV_ENDS,\n  CHUL_ONLY: CHUL_ONLY,\n  IL_ONLY: IL_ONLY,\n  LIGHT_CANDLES_TZEIS: LIGHT_CANDLES_TZEIS\n};\n\nfunction Event(date, desc, mask) {\n  var me = this;\n  me.date = new HDate(date);\n  me.desc = typeof desc != 'object' ? [desc] : desc;\n  me.USER_EVENT = !!(mask & USER_EVENT);\n  me.LIGHT_CANDLES = !!(mask & LIGHT_CANDLES);\n  me.YOM_TOV_ENDS = !!(mask & YOM_TOV_ENDS);\n  me.CHUL_ONLY = !!(mask & CHUL_ONLY);\n  me.IL_ONLY = !!(mask & IL_ONLY);\n  me.LIGHT_CANDLES_TZEIS = !!(mask & LIGHT_CANDLES_TZEIS);\n}\n\nEvent.prototype.is = function (date, il) {\n  date = new HDate(date), myDate = this.date;\n\n  if (arguments.length < 2) {\n    //il = Event.isIL;\n    il = date.il;\n  }\n\n  if (date.getDate() != myDate.getDate() || date.getMonth() != myDate.getMonth()) {\n    return false;\n  }\n\n  if (date.getFullYear() != myDate.getFullYear()) {\n    return false;\n  }\n\n  if (il && this.CHUL_ONLY || !il && this.IL_ONLY) {\n    return false;\n  }\n\n  return true;\n};\n\nEvent.prototype.masks = function () {\n  var me = this;\n  return (me.USER_EVENT && USER_EVENT) | (me.LIGHT_CANDLES && LIGHT_CANDLES) | (me.YOM_TOV_ENDS && YOM_TOV_ENDS) | (me.CHUL_ONLY && CHUL_ONLY) | (me.IL_ONLY && IL_ONLY) | (me.LIGHT_CANDLES_TZEIS && LIGHT_CANDLES_TZEIS);\n};\n\nEvent.prototype.getDesc = function (o) {\n  return c.LANG(this.desc, o);\n};\n\nEvent.prototype.candleLighting = function () {\n  var date = this.date;\n\n  if (this.LIGHT_CANDLES) {\n    return new Date(date.sunset() - Event.candleLighting * 60 * 1000);\n  } else if (this.LIGHT_CANDLES_TZEIS) {\n    return date.getZemanim().tzeit;\n  }\n\n  return null;\n};\n\nEvent.prototype.havdalah = function () {\n  if (this.YOM_TOV_ENDS) {\n    return new Date(this.date.sunset().getTime() + Event.havdalah * 60 * 1000);\n  }\n\n  return null;\n};\n\nEvent.prototype.routine = function () {\n  function routine() {\n    return !!~routine.names.indexOf(this.getDesc('s'));\n  }\n\n  routine.names = [Shabbat, 'Erev ' + Shabbat];\n  return routine;\n}();\n\nEvent.isIL = false;\nEvent.candleLighting = 18;\nEvent.havdalah = 42;\nexports.Event = Event;\n\nexports.year = function (year) {\n  if (__cache[year]) {\n    return __cache[year];\n  }\n\n  var RH = new HDate(1, TISHREI, year),\n      pesach = new HDate(15, NISAN, year),\n      tmpDate;\n  var h = {};\n\n  function add(ev) {\n    if (Array.isArray(ev)) {\n      ev.forEach(function (e) {\n        add(e);\n      });\n    } else {\n      if (h[ev.date]) {\n        h[ev.date].push(ev);\n      } else {\n        h[ev.date] = [ev];\n      }\n    }\n  }\n\n  Object.defineProperty(h, 'add', {\n    value: add\n  });\n  add([// standard holidays that don't shift based on year\n  new Event(RH, ['Rosh Hashana 1', 0, 'ראש השנה א\\''], LIGHT_CANDLES_TZEIS), new Event(new HDate(2, TISHREI, year), ['Rosh Hashana 2', 0, 'ראש השנה ב\\''], YOM_TOV_ENDS), new Event(new HDate(3 + (RH[getDay]() == days.THU), TISHREI, year), // push off to SUN if RH is THU\n  ['Tzom Gedaliah', 0, 'צום גדליה'], 0), new Event(new HDate(9, TISHREI, year), ['Erev Yom Kippur', 0, 'ערב יום כיפור'], LIGHT_CANDLES), new Event( // first SAT after RH\n  new HDate(dayOnOrBefore(SAT, 7 + RH[abs]())), [Shabbat + ' Shuva', Shabbos + ' Shuvah', 'שבת שובה'], 0), new Event(new HDate(10, TISHREI, year), ['Yom Kippur', 0, 'יום כיפור'], YOM_TOV_ENDS), new Event(new HDate(14, TISHREI, year), ['Erev Sukkot', 'Erev Succos', 'ערב סוכות'], LIGHT_CANDLES), new Event(new HDate(15, TISHREI, year), Sukkot(1), LIGHT_CANDLES_TZEIS | CHUL_ONLY), new Event(new HDate(15, TISHREI, year), Sukkot(1), YOM_TOV_ENDS | IL_ONLY), new Event(new HDate(16, TISHREI, year), Sukkot(2), YOM_TOV_ENDS | CHUL_ONLY), new Event(new HDate(16, TISHREI, year), CHM(Sukkot(2)), IL_ONLY), new Event(new HDate(17, TISHREI, year), CHM(Sukkot(3)), 0), new Event(new HDate(18, TISHREI, year), CHM(Sukkot(4)), 0), new Event(new HDate(19, TISHREI, year), CHM(Sukkot(5)), 0), new Event(new HDate(20, TISHREI, year), CHM(Sukkot(6)), 0), new Event(new HDate(21, TISHREI, year), ['Sukkot: 7 (Hoshana Raba)', 'Succos: 7 (Hoshana Raba)', 'סוכות יום ז\\' )הושנע רבה('], LIGHT_CANDLES), new Event(new HDate(22, TISHREI, year), ['Shmini Atzeret', 'Shmini Atzeres', 'שמיני עצרת'], LIGHT_CANDLES_TZEIS | CHUL_ONLY), new Event(new HDate(22, TISHREI, year), ['Shmini Atzeret / Simchat Torah', 'Shmini Atzeres / Simchas Torah', 'שמיני עצרת / שמחת תורה'], YOM_TOV_ENDS | IL_ONLY), new Event(new HDate(23, TISHREI, year), ['Simchat Torah', 'Simchas Torah', 'שמחת תורה'], YOM_TOV_ENDS | CHUL_ONLY), new Event(new HDate(24, KISLEV, year), ['Erev Chanukah', 0, 'ערב חנוכה'], 0), new Event(new HDate(25, KISLEV, year), Chanukah(1), 0), new Event(new HDate(26, KISLEV, year), Chanukah(2), 0), new Event(new HDate(27, KISLEV, year), Chanukah(3), 0), new Event(new HDate(28, KISLEV, year), Chanukah(4), 0), new Event(new HDate(29, KISLEV, year), Chanukah(5), 0), new Event(new HDate(30, KISLEV, year), // yes, i know these are wrong\n  Chanukah(6), 0), new Event(new HDate(31, KISLEV, year), // HDate() corrects the month automatically\n  Chanukah(7), 0), new Event(new HDate(32, KISLEV, year), Chanukah(8), 0), new Event(new HDate(15, months.SHVAT, year), [\"Tu B'Shvat\", 0, 'ט\"ו בשבט'], 0), new Event(new HDate(dayOnOrBefore(SAT, pesach[abs]() - 43)), [Shabbat + ' Shekalim', Shabbos + ' Shekalim', 'שבת שקלים'], 0), new Event(new HDate(dayOnOrBefore(SAT, pesach[abs]() - 30)), [Shabbat + ' Zachor', Shabbos + ' Zachor', 'שבת זכור'], 0), new Event(new HDate(pesach[abs]() - (pesach[getDay]() == days.TUE ? 33 : 31)), [\"Ta'anit Esther\", \"Ta'anis Esther\", 'תענית אסתר'], 0), new Event(new HDate(13, months.ADAR_II, year), ['Erev Purim', 0, 'ערב פורים'], 0), new Event(new HDate(14, months.ADAR_II, year), ['Purim', 0, 'פורים'], 0), new Event(new HDate(15, months.ADAR_II, year), ['Shushan Purim', 0, 'שושן פורים'], 0), new Event(new HDate(dayOnOrBefore(SAT, pesach[abs]() - 14) - 7), [Shabbat + ' Parah', Shabbos + ' Parah', 'שבת פרה'], 0), new Event(new HDate(dayOnOrBefore(SAT, pesach[abs]() - 14)), [Shabbat + ' Hachodesh', Shabbos + ' Hachodesh', 'שבת החודש'], 0), new Event(new HDate(dayOnOrBefore(SAT, pesach[abs]() - 1)), [Shabbat + ' HaGadol', Shabbos + ' HaGadol', 'שבת הגדול'], 0), new Event( // if the fast falls on Shabbat, move to Thursday\n  pesach.prev()[getDay]() == SAT ? pesach.onOrBefore(days.THU) : new HDate(14, NISAN, year), [\"Ta'anit Bechorot\", \"Ta'anis Bechoros\", 'תענית בכורות'], 0), new Event(new HDate(14, NISAN, year), ['Erev Pesach', 0, 'ערב פסח'], LIGHT_CANDLES), new Event(new HDate(15, NISAN, year), Pesach(1), LIGHT_CANDLES_TZEIS | CHUL_ONLY), new Event(new HDate(15, NISAN, year), Pesach(1), YOM_TOV_ENDS | IL_ONLY), new Event(new HDate(16, NISAN, year), Pesach(2), YOM_TOV_ENDS | CHUL_ONLY), new Event(new HDate(16, NISAN, year), CHM(Pesach(2)), IL_ONLY), new Event(new HDate(16, NISAN, year), ['Start counting Omer', 0, 'התחלת ספירת העומר'], 0), new Event(new HDate(17, NISAN, year), CHM(Pesach(3)), 0), new Event(new HDate(18, NISAN, year), CHM(Pesach(4)), 0), new Event(new HDate(19, NISAN, year), CHM(Pesach(5)), 0), new Event(new HDate(20, NISAN, year), CHM(Pesach(6)), LIGHT_CANDLES), new Event(new HDate(21, NISAN, year), Pesach(7), LIGHT_CANDLES_TZEIS | CHUL_ONLY), new Event(new HDate(21, NISAN, year), Pesach(7), YOM_TOV_ENDS | IL_ONLY), new Event(new HDate(22, NISAN, year), Pesach(8), YOM_TOV_ENDS | CHUL_ONLY), new Event(new HDate(14, months.IYYAR, year), ['Pesach Sheni', 0, 'פסח שני'], 0), new Event(new HDate(18, months.IYYAR, year), [\"Lag B'Omer\", 0, 'ל\"ג בעומר'], 0), new Event(new HDate(5, months.SIVAN, year), ['Erev Shavuot', 'Erev Shavuos', 'ערב שבועות'], LIGHT_CANDLES), new Event(new HDate(6, months.SIVAN, year), ['Shavuot 1', 'Shavuos 1', 'שבועות א\\''], LIGHT_CANDLES_TZEIS | CHUL_ONLY), new Event(new HDate(6, months.SIVAN, year), ['Shavuot', 'Shavuos', 'שבועות'], YOM_TOV_ENDS | IL_ONLY), new Event(new HDate(7, months.SIVAN, year), ['Shavuot 2', 'Shavuos 2', 'שבועות ב\\''], YOM_TOV_ENDS | CHUL_ONLY), new Event(new HDate(dayOnOrBefore(SAT, new HDate(1, TISHREI, year + 1)[abs]() - 4)), ['Leil Selichot', 'Leil Selichos', 'ליל סליחות'], 0), new Event(new HDate(29, months.ELUL, year), ['Erev Rosh Hashana', 0, 'ערב ראש השנה'], LIGHT_CANDLES)]);\n  tmpDate = new HDate(10, months.TEVET, year);\n\n  if (tmpDate[getDay]() == SAT) {\n    tmpDate = tmpDate.next();\n  }\n\n  add(new Event(tmpDate, [\"Asara B'Tevet\", 0, 'עשרה בטבת'], 0));\n\n  if (c.LEAP(year)) {\n    add(new Event(new HDate(14, months.ADAR_I, year), ['Purim Katan', 0, 'פורים קטן'], 0));\n    add(new Event(new HDate(15, months.ADAR_I, year), ['Shushan Purim Katan', 0, 'שושן פורים קטן'], 0));\n  }\n\n  if (year >= 5711) {\n    // Yom HaShoah first observed in 1951\n    tmpDate = new HDate(27, NISAN, year);\n    /* When the actual date of Yom Hashoah falls on a Friday, the\n     * state of Israel observes Yom Hashoah on the preceding\n     * Thursday. When it falls on a Sunday, Yom Hashoah is observed\n     * on the following Monday.\n     * http://www.ushmm.org/remembrance/dor/calendar/\n     */\n\n    if (tmpDate[getDay]() == days.FRI) {\n      tmpDate = tmpDate.prev();\n    } else if (tmpDate[getDay]() == days.SUN) {\n      tmpDate = tmpDate.next();\n    }\n\n    add(new Event(tmpDate, ['Yom HaShoah', 0, 'יום השואה'], 0));\n  }\n\n  add(atzmaut(year));\n\n  if (year >= 5727) {\n    // Yom Yerushalayim only celebrated after 1967\n    add(new Event(new HDate(28, months.IYYAR, year), ['Yom Yerushalayim', 0, 'יום ירושלים'], 0));\n  }\n\n  tmpDate = new HDate(17, months.TAMUZ, year);\n\n  if (tmpDate[getDay]() == SAT) {\n    tmpDate = tmpDate.next();\n  }\n\n  add(new Event(tmpDate, [\"Shiva-Asar B'Tamuz\", 0, \"צום יז' בתמוז\"], 0));\n  tmpDate = new HDate(9, months.AV, year);\n\n  if (tmpDate[getDay]() == SAT) {\n    tmpDate = tmpDate.next();\n  }\n\n  add(new Event(new HDate(dayOnOrBefore(SAT, tmpDate[abs]())), [Shabbat + ' Chazon', Shabbos + ' Chazon', 'שבת חזון'], 0));\n  add(new Event(tmpDate.prev(), [\"Erev Tish'a B'Av\", 0, 'ערב תשעה באב'], 0));\n  add(new Event(tmpDate, [\"Tish'a B'Av\", 0, 'תשעה באב'], 0));\n  add(new Event(new HDate(dayOnOrBefore(SAT, tmpDate[abs]() + 7)), [Shabbat + ' Nachamu', Shabbos + ' Nachamu', 'שבת נחמו'], 0));\n\n  for (var day = 6; day < c.daysInYear(year) + 7; day += 7) {\n    add(new Event(new HDate(dayOnOrBefore(SAT, new HDate(1, TISHREI, year)[abs]() + day)), [Shabbat, Shabbos, 'שבת'], YOM_TOV_ENDS));\n    add(new Event(new HDate(dayOnOrBefore(days.FRI, new HDate(1, TISHREI, year)[abs]() + day)), ['Erev ' + Shabbat, 'Erev ' + Shabbos, 'ערב שבת'], LIGHT_CANDLES));\n  }\n\n  for (var month = 1; month <= c.MONTH_CNT(year); month++) {\n    if ((month == NISAN ? c.daysInMonth(c.MONTH_CNT(year - 1), year - 1) : c.daysInMonth(month - 1, year)) == 30) {\n      add(new Event(new HDate(1, month, year), ['Rosh Chodesh 2', 0, \"ראש חודש ב'\"], 0));\n      add(new Event(new HDate(30, month - 1, year), ['Rosh Chodesh 1', 0, \"ראש חודש א'\"], 0));\n    } else if (month !== TISHREI) {\n      add(new Event(new HDate(1, month, year), ['Rosh Chodesh', 0, 'ראש חודש'], 0));\n    }\n\n    if (month == months.ELUL) {\n      continue;\n    }\n\n    add(new Event(new HDate(29, month, year).onOrBefore(SAT), [Shabbat + ' Mevarchim', Shabbos + ' Mevorchim', 'שבת מברכים'], 0));\n  }\n\n  return __cache[year] = h;\n};\n\nfunction atzmaut(year) {\n  if (year >= 5708) {\n    // Yom HaAtzma'ut only celebrated after 1948\n    var tmpDate = new HDate(1, months.IYYAR, year),\n        pesach = new HDate(15, NISAN, year);\n\n    if (pesach[getDay]() == days.SUN) {\n      tmpDate.setDate(2);\n    } else if (pesach[getDay]() == SAT) {\n      tmpDate.setDate(3);\n    } else if (year < 5764) {\n      tmpDate.setDate(4);\n    } else if (pesach[getDay]() == days.TUE) {\n      tmpDate.setDate(5);\n    } else {\n      tmpDate.setDate(4);\n    }\n\n    return [new Event(tmpDate, ['Yom HaZikaron', 0, 'יום הזיכרון'], 0), new Event(tmpDate.next(), [\"Yom HaAtzma'ut\", 0, 'יום העצמאות'], 0)];\n  }\n\n  return [];\n}\n\nexports.atzmaut = atzmaut;","map":null,"metadata":{},"sourceType":"script"}